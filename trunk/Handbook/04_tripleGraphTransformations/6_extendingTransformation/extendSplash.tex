\newpage
\section{Extending your transformation}
\genHeader

At this point, we now have a working TGG triple to transform a \texttt{Dictionary} into a \texttt{Box} with three \texttt{partition}s, and a \texttt{Box} with
exactly three \texttt{Partition}s into \texttt{Dictionary}. The only potential problem is that a learning box with only three partitions may not be the most
useful studying tool. After all, the more partitions you have, the more practice you'll have with the cards by being quizzed again and again.

Let's try adding a fourth partition to \texttt{source.xmi} and run the TGG again. Given that we have a rule to transform three partitions, it should at least
complete a partial transformation on them, right? 

\begin{itemize}

\item[$\blacktriangleright$] Add a \texttt{partition3} with one \texttt{card} to your \texttt{source.xmi} so that it resembles
Fig.~\ref{fig:fourthPartitionStart}. Don't forget to set the partition's \texttt{previous} attribute to \texttt{partition0}, and \texttt{partition2.next} to
\texttt{partition3}.

\begin{figure}[htbp]
\begin{center}
  \includegraphics[width=0.7\textwidth]{eclipse_fillFourthPartition}
  \caption{Adding a fourth partition to \texttt{Box}}
  \label{fig:fourthPartitionStart}
\end{center}
\end{figure}

\item[$\blacktriangleright$] An error should appear in the eMolfon console window stating that there was a problem translating your new partition, but the
forward transformation was still able to finish. In fact, if you open \texttt{source.xmi\_FWD.xmi}, you'll be able to confirm the \texttt{English Numbers
Dictionary} was still created and includes your newest card! Let's run the integrator on \texttt{corr\_fwd.xmi} once more to find out exactly how this worked.

\item[$\blacktriangleright$] Start once again with \texttt{Box}, and proceed until the integrator reaches your fourth partition. You'll notice that it
first delays processing the \texttt{partition} as it cannot find a valid rule candidate.\footnote{The message 'Possible Rule Candidate(s): ' will not be
displayed here as the element is simply ignored} Instead, it goes ahead and tries to process \texttt{card}.

\item[$\blacktriangleright$] Here the transformation is able to find a valid rule but opts to delay the action as \texttt{CardToEntryRule} needs the black
\texttt{partition} element from the \texttt{partition} to complete.\footnote{Review the \texttt{source} of your rule if confused}

\item[$\blacktriangleright$] Returning to \texttt{partition}, the transformation detects an endlessly repeating result of not finding a valid rule and so,
terminates the action. Instead of canceling the entire transformation however, it takes an optimistic approach and tries to solve \texttt{Question Four}
\emph{anyway}. The action succeeds!

\begin{figure}[htb]
\begin{center}
  \includegraphics[width=0.7\textwidth]{eclipse_integratorDebug}
  \caption{Detecting errors with the integrator}
  \label{fig:integrator_debugSuccess}
\end{center}
\end{figure}

\item[$\blacktriangleright$] The final task is to try and resolve each of the link variables, but it fails to find rule candidates for any of \texttt{previous},
\texttt{containedPartition}, or \texttt{next}, and so the transformation ends.

\clearpage

We're now presented with a dilemma. This rule, while giving us an error, \emph{works}! Our goal was never the to be able to put an \texttt{Entry} into
partitions with indexes greater than two,\footnote{As resolved in the \texttt{IndexTolevel} implementation} but simply to be able to put any \texttt{card} into
a \texttt{Dictionary}. So why not leave our transformation like this?

\vspace{0.5cm}

In short, it just feels \emph{dirty}. It just cooperates with you and manages to get the job done, and that's it. Instead, let's add a new rule to handle this
additional structure. We could keep things simple by extending the existing \texttt{BoxToDictionaryRule} by connecting a fourth partition, what if we wanted a
fifth one? A sixth? As you can see, this obviously won't work -- there will always be the potential for a \texttt{n+1}th card in an \texttt{n}-sized
box. 

\vspace{0.5cm}

While building this rule, keep in mind that the goal is to simply handle any additional elements and their connecting link variables in \texttt{Box}. This means
we don't need to create any new \emph{correspondence types} to \texttt{Dictionary}.

\end{itemize}

\jumpDual{allCards vis}{allCards tex}


\input{../6_extendingTransformation/visNewRule}

\input{../6_extendingTransformation/texNewRule}

% Not needed? remind users to check out and read the protocol in their syyntaxes for detail or run the integrator.
% \input{../6_protocol/protocolClose}
