\newpage
\hypertarget{sec:conBran}{}
\section{Conditional branching}
\genHeader

When working with SDMs, you'll often find yourself needing to decide which statement(s) to execute based on the return value of an arbitrary (black box)
operation, as we saw in \texttt{check}. In our example so far, we have implemented these constructs via SDM \emph{pattern matching}. 

With eMoflon however, there is an alternate way to construct these black boxes. In fact, this feature is yet another way of integrating handwritten java code
with your SDM! We can invoke methods directly from the \emph{if} statement. The only ``rule'' of this feature is that the method must return an
\texttt{EBoolean}: \texttt{Success} or \texttt{Failure}, corresponding to \texttt{true} or \texttt{false}, respectively. Any other values will set
\texttt{Failure} to \texttt{null}. It follows that void methods cannot be used for branching - an exception will be thrown during execution.

Unfortunately, you can't simply invoke any method from an \texttt{activity node.} Instead, you must use a new type of activity, a \texttt{statement
node}.\define{Statement Node}These are only used to guarantee a specific action, and cannot appear on their own. The can however, be used as a construct's
conditional by branching on whatever value the method returns.

Let's reconsider \texttt{grow}, the method we just completed that adds a new partition to our box. Reviewing Fig.~\ref{fig:growComplete}(Visual) or
Fig.~\ref{fig:patternComplete}, the current pattern assumes there are already at least two partitions in \texttt{box} (\texttt{firstPartitionInBox} and
\texttt{LastPartitionInBox}). What would happen if \texttt{box} had only one, or even no partitions at all? The pattern would \emph{never} find a match!

To fix this problem, let's modify \texttt{grow} so that if the original match fails, we initalize two new partitions (the first and last), but \emph{only} if it
failed due to the box being completely empty. In other words, if \texttt{box} has only one partition (an invalid state that cannot be reached by
growing from zero partitions), it cannot be grown.

\jumpDual{conBran vis}{conBran tex}

\input{../09_conditionalBranching/visConBran}

\input{../09_conditionalBranching/texConBran}
