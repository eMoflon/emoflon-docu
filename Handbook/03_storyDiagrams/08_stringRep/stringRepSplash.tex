\newpage
\hypertarget{sec:stringRep}{}
\section{String representations}
\genHeader

In the next SDM we shall create a string representation for all the contents in a single learning box. To accomplish this, we will have to iterate through 
every card, in every partition. The concept is similar to \texttt{Partition}'s \texttt{empty} method, except we'll need to create a nested loop 
(Fig.~\ref{fig:goal_stringRep}). Further still, we'll need to call another helper method to add the contents of each card to \texttt{stringRep}.

\vspace{1cm}

\begin{figure}[htbp]
	\centering
	\includegraphics[width=0.3\textwidth]{goal_stringRep.pdf}
	\caption{Nested \emph{For Each} loops}
	\label{fig:goal_stringRep}
\end{figure}

\vspace{1cm}

SDMs support arbitrary nesting of \emph{for each} story nodes via special guards. In \hyperlink{emptyPartition vis}{section 5.1} we used the \texttt{[end]} edge
guard to terminate a loop. Now we'll use a new guard, the \texttt{[each time]}\define{[each time]} guard, to indicate control flow that is \emph{nested} in
the \emph{for each} story node and executed for each match.

\vspace{0.5cm}

The first \emph{for each} loop will match all partitions, where each partition is used \texttt{[each time]} to match all the cards.  When 
all cards have been matched, the second loop \texttt{[end]}s, and returns to the outer loop.

\vspace{0.5cm}

The second \emph{for each} will need to print the contents of every card to the string. If you review your metamodel, we already declared the
\texttt{addToStringRep()} method. To invoke this, we'll create another \texttt{MethodCallExpression}.

\newpage

While we declared \texttt{addToStringRep()}, we didn't fully complete it. Analogously to how you implemented \texttt{determineNextSize} in the previous section,
quickly edit the \texttt{Box.impl} partial class again with the code in Fig.~\ref{code:addToStringRep_inject_file} and rebuild your project.

\vspace{1cm}

\begin{figure}[h!]
        \centering
        \begin{lstlisting}[language=Java, keywordstyle={\bfseries\color{purple}}, backgroundcolor=\color{white}]
    @model addToStringRep (Card card) <--

            StringBuilder sb = new StringBuilder();

            if (stringRep == null)
            {
                sb.append("BoxContent: [");

            }
            else
            {
                sb.append(stringRep);
                sb.append(", [");
            }

            sb.append(card.getFace());
            sb.append(", ");
            sb.append(card.getBack());
            sb.append("]");

            stringRep = sb.toString();
    -->
        \end{lstlisting}
        \caption{Developing \texttt{Box}'s \emph{partial class}}
        \label{code:addToStringRep_inject_file}
    \end{figure}
    \FloatBarrier

\vspace{1cm}

Comfirm the changes in \texttt{Box.impl}, and you're ready to start.

\fancyfoot[R]{ $\triangleright$ \hyperlink{stringRep vis}{Next [visual]\hspace{0.2cm} } \\ $\triangleright$ \hyperlink{stringRep tex}{Next [textual]} } 

\input{../08_stringRep/visStringRep}

\input{../08_stringRep/texStringRep}
